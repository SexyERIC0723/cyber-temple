<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è³½åšå¯ºå»Ÿ | å¿ƒèª å‰‡éˆ</title>

    <!-- Favicon å¤ªæå›¾æ ‡ -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700;900&family=Ma+Shan+Zheng&display=swap"
        rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/jiaobei.css">
</head>

<body>
    <div class="bg-gradient"></div>
    <div class="ambient-glow"></div>
    <div class="particles" id="particles"></div>
    <div class="temple-decor"></div>
    <div class="lantern-glow left"></div>
    <div class="lantern-glow right"></div>
    <div class="incense-smoke"></div>
    <div class="smoke-container" id="smoke-container"></div>
    <div id="canvas-container"></div>
    <div class="noise"></div>
    <div class="crt-overlay"></div>
    <div class="flash-overlay" id="flash-overlay"></div>

    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="top-nav">
        <div class="nav-brand">
            <span class="nav-logo">â˜¯</span>
            <span class="nav-title">è³½åšå¯ºå»Ÿ</span>
        </div>
        <div class="nav-links">
            <a href="jiaobei.html" class="nav-link active">
                <img src="zhijiao.png" alt="æ·ç­Š" class="nav-icon-img">
                <span class="nav-text">æ·ç­Š</span>
            </a>
            <a href="qian.html" class="nav-link">
                <img src="chouqian.png" alt="æ±‚ç±¤" class="nav-icon-img">
                <span class="nav-text">æ±‚ç±¤</span>
            </a>
            <a href="yuan.html" class="nav-link">
                <img src="xuyuan.png" alt="è¨±é¡˜" class="nav-icon-img">
                <span class="nav-text">è¨±é¡˜</span>
            </a>
        </div>

        <div class="nav-actions">
            <div class="mode-switch-container">
                <label class="switch">
                    <input type="checkbox" id="mode-toggle">
                    <span class="slider round"></span>
                </label>
                <span class="mode-label" id="mode-label">å…è²»æ¨¡å¼</span>
            </div>
            <button class="btn-wallet" id="btn-connect">é€£çµéŒ¢åŒ…</button>
        </div>
    </nav>

    <div class="wallet-info hidden" id="wallet-info">
        <div class="info-item">
            <span class="label">é¤˜é¡:</span>
            <span class="value" id="user-balance">0.00</span> BEI
            <button class="btn-add-token" id="btn-add-token" title="æ·»åŠ åˆ° MetaMask">+</button>
            <button class="btn-faucet" id="btn-faucet" title="é ˜å–æ¸¬è©¦å¹£">ğŸ’°</button>
        </div>
        <div class="info-item jackpot">
            <span class="label">ğŸ† çæ± :</span>
            <span class="value" id="jackpot-pool">0.00</span> BEI
        </div>
    </div>

    <button class="audio-toggle" id="audio-toggle" title="éŸ³æ•ˆé–‹é—œ">ğŸ”Š</button>

    <div id="ui-layer">
        <!-- Phase 1: Question -->
        <div class="temple-frame phase active" id="phase-question">
            <h1 class="title">æ“² ç­Š</h1>
            <p class="subtitle">Â· ç¥æ˜æŒ‡å¼• Â·</p>
            <div class="deity-silhouette"></div>
            <div class="dialog-box">
                <p class="dialog-text">å–„ä¿¡ï¼Œå¿ƒä¸­æ‰€æƒ‘ç‚ºä½•ï¼Ÿ</p>
            </div>
            <textarea class="question-input" id="question-input" placeholder="è«‹è™”èª åœ°è¼¸å…¥æ‚¨çš„å•é¡Œ..." maxlength="200"></textarea>
            <button class="btn" id="btn-pray">ç„š é¦™ ç¦± å‘Š</button>
        </div>

        <!-- Loading: Incense -->
        <div class="temple-frame loading" id="loading-incense">
            <h1 class="title">æ“² ç­Š</h1>
            <p class="subtitle">Â· ç¥æ˜æŒ‡å¼• Â·</p>
            <div class="incense-animation"></div>
            <p class="loading-text">é¦™ç…™è£Šè£Šï¼Œå‚³é”å¤©è½...</p>
        </div>

        <!-- Phase 2: Toss Button -->
        <div class="toss-container hidden" id="phase-toss">
            <p class="toss-hint">èª å¿ƒé»˜ç¦±ï¼Œé»æ“Šæ“²ç­Š</p>
            <button class="btn" id="btn-toss">æ“² ç­Š</button>
        </div>

        <!-- Phase 3: Result -->
        <div class="temple-frame phase hidden" id="phase-result">
            <h1 class="title">æ“² ç­Š</h1>
            <p class="subtitle">Â· ç¥æ˜æŒ‡å¼• Â·</p>
            <div class="result-container">
                <div class="jiaobei-result" id="jiaobei-result"></div>
                <h2 class="result-title" id="result-title"></h2>
                <p class="result-description" id="result-description"></p>
                <div class="fortune-text" id="fortune-text"></div>
                <button class="btn" id="btn-retry">å† å• ä¸€ æ¬¡</button>
            </div>
        </div>
    </div>

    <!-- Import Map for ES Modules -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://esm.sh/three@0.160.0",
                "three/addons/": "https://esm.sh/three@0.160.0/examples/jsm/",
                "cannon-es": "https://esm.sh/cannon-es@0.20.0",
                "ethers": "https://esm.sh/ethers@6.13.2"
            }
        }
    </script>

    <!-- JavaScript (ES Module) -->
    <script type="module" src="js/jiaobei.js"></script>
</body>

</html>